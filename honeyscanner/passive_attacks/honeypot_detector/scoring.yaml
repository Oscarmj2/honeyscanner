# Honeypot name
#   Protocol ("ssh", "telnet", "http", "https", "dicom")
#   steps
#     - input (Input to sent to the server)
#       output (Expected output from sending input to server)
#       match_type ("precise" or "fuzzy" whether output == response or output in response)
#       score (Value between 0 and 1)
#   custom_functions
#     - function_name (name of the python function to call)
#       score (same as steps score. Score of 0 lets you set the score in the function itself)

# Suggested naming of custom functions (HONEYPOTNAME_FUNCTIONNAME)
# Example i want to create a function for timing detection for go-pot
# -> gopot_timing

# "http" & "https" gives two more fields in steps
# 1. response_code: (Response code from the http request)
# 2. method: ("get" & "post" which http method to use for the request)

# Currently a problem with the mounts where each line is missing \r which can't be added manually
cowrie:
  protocol: "ssh"
  steps:
    - input: "cat /proc/version"
      output: "Linux version 3.2.0-4-amd64 (debian-kernel@lists.debian.org) (gcc version 4.6.3 (Debian 4.6.3-14) ) #1 SMP Debian 3.2.68-1+deb7u1"
      match_type: "fuzzy"
      score: 0.1
    - input: "cat /proc/meminfo"
      output: "MemFree:          997740 kB"
      match_type: "fuzzy"
      score: 0.1
    - input: "cat /proc/cpuinfo"
      output: "model name\t: Intel(R) Core(TM)2 Duo CPU     E8200  @ 2.66GHz"
      match_type: "fuzzy"
      score: 0.1
    - input: "cat /etc/group"
      output: "phil"
      match_type: "fuzzy"
      score: 0.1
    - input: "cat /etc/shadow"
      output: "phil"
      match_type: "fuzzy"
      score: 0.1
    - input: "cat /etc/passwd"
      output: "phil"
      match_type: "fuzzy"
      score: 0.1
    - input: "hostname"
      output: "svr04"
      match_type: "fuzzy"
      score: 0.1
    - input: "cat /proc/mounts"
      output: |-
        rootfs / rootfs rw 0 0
        sysfs /sys sysfs rw,nosuid,nodev,noexec,relatime 0 0
        proc /proc proc rw,relatime 0 0\r
        udev /dev devtmpfs rw,relatime,size=10240k,nr_inodes=997843,mode=755 0 0
        devpts /dev/pts devpts rw,nosuid,noexec,relatime,gid=5,mode=620,ptmxmode=000 0 0
        tmpfs /run tmpfs rw,nosuid,relatime,size=1613336k,mode=755 0 0
        /dev/dm-0 / ext3 rw,relatime,errors=remount-ro,data=ordered 0 0
        tmpfs /dev/shm tmpfs rw,nosuid,nodev 0 0
        tmpfs /run/lock tmpfs rw,nosuid,nodev,noexec,relatime,size=5120k 0 0
        systemd-1 /proc/sys/fs/binfmt_misc autofs rw,relatime,fd=22,pgrp=1,timeout=300,minproto=5,maxproto=5,direct 0 0
        fusectl /sys/fs/fuse/connections fusectl rw,relatime 0 0
        /dev/sda1 /boot ext2 rw,relatime 0 0
        /dev/mapper/home /home ext3 rw,relatime,data=ordered 0 0
        binfmt_misc /proc/sys/fs/binfmt_misc binfmt_misc rw,relatime 0 0
      match_type: "fuzzy"
      score: 0.1
  custom_functions:
    - function_name: "cowrie_memory_persistence"
      score: 0.8

# Works in current state
miniprint:
  protocol: "telnet"
  steps:
    - input: "@PJL FSDIRLIST NAME = \"THISISAHONEYPOT:/\""
      output: "@PJL FSDIRLIST NAME=THISISAHONEYPOT:/ ENTRY=1"
      match_type: "fuzzy"
      score: 0.7
    - input: "@PJL FSDIRLIST NAME=\"0:\""
      output: "@PJL FSDIRLIST NAME=\"0:\"FILEERROR = 3"
      match_type: "precise"
      score: 0.5
  costum_functions:
    - function_name: ""
      score: ""

# Works in current state
redishoneypot:
  protocol: "telnet"
  steps:
    - input: "ping IsThisAHoneypot?"
      output: "+PONG\r\n"
      match_type: "precise"
      score: 0.8
  costum_functions:
    - function_name: ""
      score: ""


dicompot:
  protocol: "dicom"
  steps:
    - input: ""
      output: ""
      match_type: ""
      score: ""
  costum_functions:
    - function_name: ""
      score: ""

# Works in current state
honeyaml:
  protocol: "http"
  steps:
    - input: "/IsThisAHoneypot"
      output: "<html>\n<body>Authenticate through /auth first</body>\n</html>\n\n"
      response_code: 201
      method: "get"
      match_type: "precise"
      score: 0.3
    - input: "/end-point1/foo"
      output: "Hello world\n"
      response_code: 201
      method: "get"
      match_type: "precise"
      score: 0.4
    - input: "/end-point1"
      output: "{\n  \"doc_id\": 2,\n  \"field\" : \"hello poster\"\n}\n\n"
      response_code: 418
      method: "post"
      match_type: "precise"
      score: 0.4
  costum_functions:
    - function_name: ""
      score: ""


h0neytr4p:
  protocol: "https"
  steps:
    - input: "/IsThisAHoneypot/.git"
      output: "[core]\n\trepositoryformatversion = 0\n\tfilemode = true\n\tbare = false\n\tlogallrefupdates = true\n[remote \"origin\"]\n\turl = https://github.com/wouterbeek/LOD-a-lot-www.git\n\tfetch = +refs/heads/*:refs/remotes/origin/*\n[branch \"master\"]\n\tremote = origin\n\tmerge = refs/heads/master"
      response_code: 200
      method: "get"
      match_type: "precise"
      score: 0.8
    - input: "/IsThisAHoneypot2"
      output: ""
      response_code: 200
      method: "get"
      match_type: "fuzzy"
      score: 0.3
  costum_functions:
    - function_name: ""
      score: ""

# Entry done for now
go-pot:
  protocol: "http"
  steps:
    - input: "/IsThisAHoneypot.json"
      output: ""
      response_code: 200
      method: "get"
      match_type: "fuzzy"
      score: 0.3
  costum_functions:
    - function_name: "gopot_timing"
      score: 0.6